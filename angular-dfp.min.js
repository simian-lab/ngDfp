var googletag=googletag||{};googletag.cmd=googletag.cmd||[];
angular.module("ngDfp",[]).constant("ngDfpUrl","//www.googletagservices.com/tag/js/gpt.js").provider("DoubleClick",["ngDfpUrl",function(f){var c={},g={},e={},q=null,m=!0,n={},p=!1,k=!0;this._createTag=function(a){if(m){var b=document.createElement("script"),d="https:"===document.location.protocol,h=document.getElementsByTagName("script")[0];b.async=!0;b.type="text/javascript";b.src=(d?"https:":"http:")+f;h.parentNode.insertBefore(b,h);b.onreadystatechange=function(){"complete"==this.readyState&&a()};
b.onload=a}};this._initialize=function(){var a=this;googletag.cmd.push(function(){angular.forEach(c,function(a,d){g[d]=googletag.defineSlot.apply(null,a).addService(googletag.pubads());e[d]&&g[d].defineSizeMapping(e[d]);var h=a.getSlotTargeting();h&&angular.forEach(h,function(a,b){g[d].setTargeting(a.id,a.value)})});angular.forEach(n,function(a,d){googletag.pubads().setTargeting(d,a)});p&&googletag.pubads().collapseEmptyDivs();k&&googletag.pubads().enableSingleRequest();googletag.enableServices();
googletag.pubads().addEventListener("slotRenderEnded",a._slotRenderEnded)})};this._slotRenderEnded=function(a){a=c[a.slot.getSlotId().getDomId()].renderCallback;"function"===typeof a&&a()};this._refreshInterval=function(){return q};this.setRefreshInterval=function(a){q=a;return this};this.defineSlot=function(){var a=arguments;a.getSize=function(){return this[1]};a.getSlotTargeting=function(){return this[3]?this[3]:!1};a.setRenderCallback=function(a){this.renderCallback=a};c[arguments[2]]=a;return this};
this.defineSizeMapping=function(a){e[a]||(e[a]=[]);this.addSize=function(b,d){e[a].push([b,d]);return this};return this};this.setEnabled=function(a){m=a};this.setPageTargeting=function(a,b){n[a]=b};this.collapseEmptyDivs=function(){p=!0};this.setSingleRequest=function(a){k=a};var l=this;this.$get=["$q","$window","$interval",function(a,b,d){var h=a.defer();l._createTag(function(){l._initialize();null!==l._refreshInterval()&&d(function(){googletag.cmd.push(function(){b.googletag.pubads().refresh()})},
l._refreshInterval());h.resolve()});return{getAdSize:function(a){return h.promise.then(function(){if(angular.isUndefined(c[a]))throw"Slot "+a+" has not been defined. Define it using DoubleClickProvider.defineSlot().";return c[a][1]})},getSlot:function(a){return h.promise.then(function(){if(angular.isUndefined(c[a]))throw"Slot "+a+" has not been defined. Define it using DoubleClickProvider.defineSlot().";return c[a]})},runAd:function(a){googletag.cmd.push(function(){b.googletag.display(a)})},refreshAds:function(){var a=
[];angular.forEach(arguments,function(b){a.push(g[b])});googletag.cmd.push(function(){b.googletag.pubads().refresh(a)})}}}]}]).directive("ngDfpAdContainer",function(){return{restrict:"A",controller:["$element",function(f){this.$$setVisible=function(c,g){c?"visibility"===g?f.css("visibility","visible"):f.show():"visibility"===g?f.css("visibility","hidden"):f.hide()}}]}}).directive("ngDfpAd",["$timeout","$parse","$interval","DoubleClick",function(f,c,g,e){return{restrict:"A",template:'<div id="{{adId}}"></div>',
require:"?^ngDfpAdContainer",scope:{adId:"@ngDfpAd",refresh:"@ngDfpAdRefresh",interval:"@ngDfpAdRefreshInterval",timeout:"@ngDfpAdRefreshTimeout"},replace:!0,link:function(c,m,n,p){c.$watch("adId",function(k){m.html("");var l=null,a=null;e.getSlot(k).then(function(b){var d=b.getSize();m.css("width",d[0]).css("height",d[1]);f(function(){e.runAd(k)});p&&b.setRenderCallback(function(){angular.isDefined(n.ngDfpAdHideWhenEmpty)&&(0===m.find("iframe:not([id*=hidden])").map(function(){return this.contentWindow.document}).find("body").children().length?
p.$$setVisible(!1,n.ngDfpAdHideWhenEmpty):p.$$setVisible(!0,n.ngDfpAdHideWhenEmpty))});c.$watch("refresh",function(a){angular.isUndefined(a)||e.refreshAds(k)});c.$watch("interval",function(a){angular.isUndefined(a)||(l=g(function(){e.refreshAds(k)},c.interval))});c.$watch("timeout",function(b){angular.isUndefined(b)||(a=f(function(){e.refreshAds(k)},c.timeout))});c.$on("$destroy",function(){g.cancel(l);f.cancel(a);a=l=null})})})}}}]);
